(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06a80908"],{1799:function(e,t,n){"use strict";var c=n("7a23"),o={key:0,class:"mt-3"},a={class:"pagination justify-content-center"},l={key:0,class:"page-item"},r=Object(c["createElementVNode"])("span",null,"⫷",-1),s=[r],i=["onClick"],d={key:1,class:"page-item"},u=Object(c["createElementVNode"])("span",null,"⫸",-1),p=[u];function b(e,t,n,r,u,b){return n.pages.total_pages>1?(Object(c["openBlock"])(),Object(c["createElementBlock"])("nav",o,[Object(c["createElementVNode"])("ul",a,[n.pages.has_pre?(Object(c["openBlock"])(),Object(c["createElementBlock"])("li",l,[Object(c["createElementVNode"])("a",{class:"page-link",href:"#",onClick:t[0]||(t[0]=Object(c["withModifiers"])((function(e){return b.changePage(n.pages.current_page-1)}),["prevent"]))},s)])):Object(c["createCommentVNode"])("",!0),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.pages.total_pages,(function(e){return Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{class:Object(c["normalizeClass"])(["page-item",{active:e===n.pages.current_page}]),key:e},[Object(c["createElementVNode"])("a",{class:"page-link",href:"#",onClick:Object(c["withModifiers"])((function(t){return b.changePage(e)}),["prevent"])},Object(c["toDisplayString"])(e),9,i)],2)})),128)),n.pages.has_next?(Object(c["openBlock"])(),Object(c["createElementBlock"])("li",d,[Object(c["createElementVNode"])("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=Object(c["withModifiers"])((function(e){return b.changePage(n.pages.current_page+1)}),["prevent"]))},p)])):Object(c["createCommentVNode"])("",!0)])])):Object(c["createCommentVNode"])("",!0)}var m=n("7d47"),j={props:["pages"],methods:{changePage:function(e){this.$emit("emit-page",e),Object(m["a"])()}}},O=n("6b0d"),h=n.n(O);const f=h()(j,[["render",b]]);t["a"]=f},"4b91":function(e,t,n){"use strict";var c=n("7a23"),o=n("eaaf"),a=n.n(o),l={class:"modal fade",tabindex:"-1",ref:"modal"},r={class:"modal-dialog modal-dialog-centered"},s={class:"modal-content"},i={class:"modal-body text-center"},d=Object(c["createElementVNode"])("img",{class:"spinner-slow mb-3",src:a.a,width:"165",alt:"Loading..."},null,-1),u=Object(c["createElementVNode"])("p",{class:"fs-5 text-danger"},[Object(c["createTextVNode"])("警告 "),Object(c["createElementVNode"])("i",{class:"bi bi-exclamation-diamond"}),Object(c["createTextVNode"])("：刪除後無法復原，確認刪除")],-1),p={class:"mb-0 fs-5 fw-bold text-dark"},b={key:0},m={key:1},j={class:"p-3 text-center"},O=Object(c["createElementVNode"])("i",{class:"bi bi-trash me-2"},null,-1),h=Object(c["createTextVNode"])("確認刪除"),f=[O,h],V=Object(c["createElementVNode"])("button",{class:"btn btn-outline-gray-600 w-70",type:"button","data-bs-dismiss":"modal"},"取消",-1);function E(e,t,n,o,a,O){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",l,[Object(c["createElementVNode"])("div",r,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("div",i,[d,u,Object(c["createElementVNode"])("p",p,[Object(c["createTextVNode"])(Object(c["toDisplayString"])(n.itemClass)+"：",1),a.tempItem.title?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",b,Object(c["toDisplayString"])(a.tempItem.title)+"？",1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",m,Object(c["toDisplayString"])(a.tempItem.id)+"？",1))])]),Object(c["createElementVNode"])("div",j,[Object(c["createElementVNode"])("button",{class:"btn btn-danger w-70 mb-2",type:"button",onClick:t[0]||(t[0]=function(){return O.check&&O.check.apply(O,arguments)})},f),V])])])],512)}var g=n("5530"),N=n("e0ae"),k={data:function(){return{tempItem:{}}},mixins:[N["a"]],props:{item:{type:Object,default:function(){return{}}},itemClass:{type:String,default:function(){return"物件"}}},watch:{item:function(){this.tempItem=Object(g["a"])({},this.item)}},methods:{check:function(){this.$emit("emit-delete",this.tempItem)}}},v=n("6b0d"),C=n.n(v);const w=C()(k,[["render",E]]);t["a"]=w},"8c58":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),o=Object(c["createElementVNode"])("i",{class:"bi bi-file-earmark-plus"},null,-1),a=[o],l={key:0,class:"w-100 overflow-auto text-nowrap text-center"},r={class:"table table-sm table-light table-striped table-hover align-middle"},s=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,[Object(c["createTextVNode"])("名稱"),Object(c["createElementVNode"])("i",{class:"bi bi-pencil-square ms-2"})]),Object(c["createElementVNode"])("th",null,"代碼"),Object(c["createElementVNode"])("th",null,"折數"),Object(c["createElementVNode"])("th",null,"到期日"),Object(c["createElementVNode"])("th",null,"啟用"),Object(c["createElementVNode"])("th")])],-1),i=["onClick"],d={class:"form-switch text-center"},u=["onUpdate:modelValue","onChange"],p=["onClick"],b=Object(c["createElementVNode"])("i",{class:"bi bi-pencil-square"},null,-1),m=[b],j=["onClick"],O=Object(c["createElementVNode"])("i",{class:"bi bi-trash"},null,-1),h=[O];function f(e,t,n,o,b,O){var f=Object(c["resolveComponent"])("Pagination"),V=Object(c["resolveComponent"])("CouponModal"),E=Object(c["resolveComponent"])("DeleteModal"),g=Object(c["resolveComponent"])("VueLoading");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createElementVNode"])("a",{class:"btn btn-secondary btn-fixed fs-3 hover-half-transparent text-light border-0",href:"#",title:"新增優惠卷",onClick:t[0]||(t[0]=Object(c["withModifiers"])((function(e){return O.openModal(!0)}),["prevent"]))},a),b.coupons.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("section",l,[Object(c["createElementVNode"])("table",r,[s,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(b.coupons,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("a",{class:"link-dark text-decoration-none",href:"#",onClick:Object(c["withModifiers"])((function(e){return O.openModal(!1,t)}),["prevent"])},Object(c["toDisplayString"])(t.title),9,i)]),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.code),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.percent/10)+"折",1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.date(t.due_date)),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("div",d,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input me-0 p-2 shadow-0",id:"productEnabled",type:"checkbox",role:"switch","onUpdate:modelValue":function(e){return t.is_enabled=e},"true-value":1,"false-value":0,onChange:function(e){return O.updateCoupon(t)}},null,40,u),[[c["vModelCheckbox"],t.is_enabled]])])]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("button",{class:"border-0 hover-gray py-2 d-block w-100",type:"button",title:"編輯",onClick:function(e){return O.openModal(!1,t)}},m,8,p),Object(c["createElementVNode"])("button",{class:"border-0 hover-red py-2 d-block w-100",type:"button",title:"刪除",onClick:function(e){return O.checkDelete(t)}},h,8,j)])])})),128))])])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(f,{pages:b.pagination,onEmitPage:O.getCoupons},null,8,["pages","onEmitPage"]),Object(c["createVNode"])(V,{ref:"couponModal",coupon:b.tempCoupon,onEmitCoupon:O.updateCoupon},null,8,["coupon","onEmitCoupon"]),Object(c["createVNode"])(E,{ref:"deleteModal",item:b.tempCoupon,itemClass:"優惠卷",onEmitDelete:O.delCoupon},null,8,["item","onEmitDelete"]),Object(c["createVNode"])(g,{active:b.isLoading},null,8,["active"])],64)}var V=n("5530"),E=n("1da1"),g=(n("96cf"),n("99af"),n("d3b7"),n("e9c4"),n("1799")),N={class:"modal fade",id:"modal_product",tabindex:"-1",ref:"modal"},k={class:"modal-dialog modal-dialog-centered"},v=Object(c["createElementVNode"])("div",{class:"modal-header p-2 mb-3"},[Object(c["createElementVNode"])("h5",{class:"modal-title"},"編輯優惠卷"),Object(c["createElementVNode"])("button",{class:"btn-close",type:"button","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},w={class:"row"},y=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"couponName"},"優惠卷：",-1),x={class:"col-9 mb-2"},M=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"couponCode"},"優惠碼：",-1),_={class:"col-9 mb-2"},B=Object(c["createElementVNode"])("div",{class:"w-100"},null,-1),D=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"couponDueDate"},"到期日：",-1),T={class:"col mb-2"},P=Object(c["createElementVNode"])("div",{class:"w-100"},null,-1),S=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"couponPercent"},"折數：",-1),I={class:"col-6 mb-2"},L={class:"input-group"},$=Object(c["createElementVNode"])("span",{class:"input-group-text"},"折",-1),U=Object(c["createElementVNode"])("div",{class:"w-100"},null,-1),q=Object(c["createElementVNode"])("div",{class:"col-3 py-1"},"啟用：",-1),R={class:"col-6 text-center"},z={class:"form-switch py-1"},A={class:"form-label",for:"couponIsEnabled"},F={key:0,class:"text-success"},J={key:1,class:"text-danger"},G=Object(c["createElementVNode"])("div",{class:"w-100"},null,-1),H=Object(c["createElementVNode"])("div",{class:"modal-footer p-0 pt-2 mt-3"},[Object(c["createElementVNode"])("button",{class:"btn btn-cyan-600 text-white w-30",type:"submit"},[Object(c["createElementVNode"])("i",{class:"bi bi-check-lg me-2"}),Object(c["createTextVNode"])("送出")]),Object(c["createElementVNode"])("button",{class:"btn btn-outline-gray-600 w-20",type:"button","data-bs-dismiss":"modal"},"取消")],-1);function K(e,t,n,o,a,l){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",N,[Object(c["createElementVNode"])("div",k,[Object(c["createElementVNode"])("form",{class:"modal-content p-3",onSubmit:t[5]||(t[5]=Object(c["withModifiers"])((function(){return l.update&&l.update.apply(l,arguments)}),["prevent"]))},[v,Object(c["createElementVNode"])("div",C,[Object(c["createElementVNode"])("div",w,[y,Object(c["createElementVNode"])("div",x,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-control ps-2",id:"couponName",type:"text",required:"","onUpdate:modelValue":t[0]||(t[0]=function(e){return a.tempCoupon.title=e})},null,512),[[c["vModelText"],a.tempCoupon.title]])]),M,Object(c["createElementVNode"])("div",_,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-control ps-2",id:"couponCode",type:"text",required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.tempCoupon.code=e})},null,512),[[c["vModelText"],a.tempCoupon.code]])]),B,D,Object(c["createElementVNode"])("div",T,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-control ps-2",id:"couponDueDate",type:"date",required:"","onUpdate:modelValue":t[2]||(t[2]=function(e){return a.due_date=e})},null,512),[[c["vModelText"],a.due_date]])]),P,S,Object(c["createElementVNode"])("div",I,[Object(c["createElementVNode"])("div",L,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-control ps-2",id:"couponPercent",type:"number",min:"0.1",max:"9.9",step:"0.1","onUpdate:modelValue":t[3]||(t[3]=function(e){return a.discount=e}),required:""},null,512),[[c["vModelText"],a.discount]]),$])]),U,q,Object(c["createElementVNode"])("div",R,[Object(c["createElementVNode"])("div",z,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input p-2 me-2",id:"couponIsEnabled",type:"checkbox",role:"switch","onUpdate:modelValue":t[4]||(t[4]=function(e){return a.is_enabled=e}),"true-value":1,"false-value":0},null,512),[[c["vModelCheckbox"],a.is_enabled]]),Object(c["createElementVNode"])("label",A,[a.is_enabled?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",F,"啟用")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",J,"未啟用"))])])]),G])]),H],32)])],512)}var Q=n("3835"),W=(n("ac1f"),n("1276"),n("e0ae")),X={data:function(){return{tempCoupon:{},due_date:"",is_enabled:1,discount:.1}},mixins:[W["a"]],props:{coupon:{type:Object,default:function(){return{}}}},watch:{coupon:function(){if(this.tempCoupon=Object(V["a"])({},this.coupon),this.tempCoupon.due_date){var e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T"),t=Object(Q["a"])(e,1);this.due_date=t[0],this.is_enabled=this.tempCoupon.is_enabled,this.discount=this.tempCoupon.percent/10}else this.due_date="",this.is_enabled=0,this.discount=0},due_date:function(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{update:function(){this.tempCoupon.is_enabled=this.is_enabled,this.tempCoupon.percent=10*this.discount,this.$emit("emit-coupon",this.tempCoupon)}}},Y=n("6b0d"),Z=n.n(Y);const ee=Z()(X,[["render",K]]);var te=ee,ne=n("4b91"),ce={metaInfo:{title:"優惠卷"},data:function(){return{coupons:[],tempCoupon:{},pagination:{},currentPage:1,isNew:!1,isLoading:!1}},components:{Pagination:g["a"],CouponModal:te,DeleteModal:ne["a"]},inject:["tokenValue","pushToast"],methods:{getCoupons:function(){var e=arguments,t=this;return Object(E["a"])(regeneratorRuntime.mark((function n(){var c,o,a,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return c=e.length>0&&void 0!==e[0]?e[0]:1,t.isLoading=!0,t.currentPage=c,o="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/coupons?page=").concat(c,"\n      "),n.prev=4,n.next=7,fetch(o,{headers:{Authorization:t.tokenValue}});case 7:return a=n.sent,n.next=10,a.json();case 10:l=n.sent,t.coupons=l.coupons,t.pagination=l.pagination,n.next=18;break;case 15:n.prev=15,n.t0=n["catch"](4),console.error(n.t0);case 18:t.isLoading=!1;case 19:case"end":return n.stop()}}),n,null,[[4,15]])})))()},openModal:function(e,t){this.isNew=e,this.tempCoupon=e?{}:Object(V["a"])({},t),this.$refs.couponModal.showModal()},updateCoupon:function(e){var t=this;return Object(E["a"])(regeneratorRuntime.mark((function n(){var c,o,a,l,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$refs.couponModal.hideModal(),t.isNew?(c="\n          ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/coupon\n        "),o="post",a=1):(c="\n          ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/coupon/").concat(e.id,"\n        "),o="put",a=t.currentPage),l={data:Object(V["a"])({},e)},n.prev=3,n.next=6,fetch(c,{method:o,headers:{Authorization:t.tokenValue,"Content-Type":"application/json"},body:JSON.stringify(l)});case 6:return r=n.sent,n.next=9,r.json();case 9:s=n.sent,t.getCoupons(a),t.pushToast(s,"優惠卷"),n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](3),console.error(n.t0);case 17:t.isNew=!1;case 18:case"end":return n.stop()}}),n,null,[[3,14]])})))()},checkDelete:function(e){this.tempCoupon=Object(V["a"])({},e),this.$refs.deleteModal.showModal()},delCoupon:function(e){var t=this;return Object(E["a"])(regeneratorRuntime.mark((function n(){var c,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$refs.deleteModal.hideModal(),c="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/coupon/").concat(e.id,"\n      "),n.prev=2,n.next=5,fetch(c,{method:"delete",headers:{Authorization:t.tokenValue}});case 5:return o=n.sent,n.next=8,o.json();case 8:a=n.sent,t.pushToast(a,"優惠卷"),a.success&&t.getCoupons(t.currentPage),n.next=16;break;case 13:n.prev=13,n.t0=n["catch"](2),console.error(n.t0);case 16:case"end":return n.stop()}}),n,null,[[2,13]])})))()}},created:function(){this.getCoupons()}};const oe=Z()(ce,[["render",f]]);t["default"]=oe},eaaf:function(e,t,n){e.exports=n.p+"img/black_hole.cdb62289.svg"}}]);
//# sourceMappingURL=chunk-06a80908.fdf8f86e.js.map