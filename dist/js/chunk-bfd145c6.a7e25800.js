(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bfd145c6"],{"06bf":function(e,t,c){},4082:function(e,t,c){"use strict";c("06bf")},8249:function(e,t,c){},d947:function(e,t,c){"use strict";c("8249")},e6dc:function(e,t,c){"use strict";c.r(t);var o=c("7a23"),n=function(e){return Object(o["pushScopeId"])("data-v-217a2e33"),e=e(),Object(o["popScopeId"])(),e},r=n((function(){return Object(o["createElementVNode"])("i",{class:"bi bi-clipboard-plus"},null,-1)})),a=[r],l={key:0,class:"w-100 overflow-auto text-nowrap"},i={class:"table table-sm table-light table-striped table-hover align-middle text-center"},d=n((function(){return Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"縮圖"),Object(o["createElementVNode"])("th",null,[Object(o["createTextVNode"])("商品名稱"),Object(o["createElementVNode"])("i",{class:"bi bi-pencil-square ms-2"})]),Object(o["createElementVNode"])("th",{class:"d-none d-sm-table-cell"},"分類"),Object(o["createElementVNode"])("th",null,"售價"),Object(o["createElementVNode"])("th",{class:"d-none d-sm-table-cell"},"原價"),Object(o["createElementVNode"])("th",{class:"d-none d-sm-table-cell",width:"50"},"上架"),Object(o["createElementVNode"])("th")])],-1)})),s={class:"img overflow-hidden"},u=["src"],m=["onClick"],p={class:"d-none d-sm-table-cell"},b={class:"d-none d-sm-table-cell"},f={class:"d-none d-sm-table-cell"},j={class:"form-switch text-center"},O=["onUpdate:modelValue","onChange"],h=["onClick"],g=n((function(){return Object(o["createElementVNode"])("i",{class:"bi bi-pencil-square"},null,-1)})),v=[g],V=["onClick"],E=n((function(){return Object(o["createElementVNode"])("i",{class:"bi bi-trash"},null,-1)})),N=[E];function k(e,t,c,n,r,g){var E=Object(o["resolveComponent"])("Pagination"),k=Object(o["resolveComponent"])("ProductModal"),w=Object(o["resolveComponent"])("DeleteModal"),P=Object(o["resolveComponent"])("VueLoading");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("a",{class:"btn btn-secondary btn-fixed fs-3 hover-half-transparent text-light border-0",title:"新增品項",onClick:t[0]||(t[0]=Object(o["withModifiers"])((function(e){return g.openModal(!0)}),["prevent"]))},a),r.products.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("section",l,[Object(o["createElementVNode"])("table",i,[d,Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.products,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.id},[Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("img",{class:"img-fluid",src:t.imageUrl},null,8,u)])]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("a",{class:"link-dark text-decoration-none",href:"#",onClick:Object(o["withModifiers"])((function(e){return g.openModal(!1,t)}),["prevent"]),title:"編輯察看"},Object(o["toDisplayString"])(t.title),9,m)]),Object(o["createElementVNode"])("td",p,Object(o["toDisplayString"])(t.category),1),Object(o["createElementVNode"])("td",null,"$"+Object(o["toDisplayString"])(e.$filters.currency(t.price)),1),Object(o["createElementVNode"])("td",b,"$"+Object(o["toDisplayString"])(e.$filters.currency(t.origin_price)),1),Object(o["createElementVNode"])("td",f,[Object(o["createElementVNode"])("div",j,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-check-input me-0 p-2 shadow-0",id:"productEnabled",type:"checkbox",role:"switch","onUpdate:modelValue":function(e){return t.is_enabled=e},"true-value":"1","false-value":"0",onChange:function(e){return g.updateProduct(t)}},null,40,O),[[o["vModelCheckbox"],t.is_enabled]])])]),Object(o["createElementVNode"])("td",null,[Object(o["createElementVNode"])("button",{class:"border-0 hover-gray py-2 px-2 d-block w-100",type:"button",title:"編輯",onClick:Object(o["withModifiers"])((function(e){return g.openModal(!1,t)}),["prevent"])},v,8,h),Object(o["createElementVNode"])("button",{class:"border-0 hover-red py-2 px-2 d-block w-100",type:"button",title:"刪除",onClick:Object(o["withModifiers"])((function(e){return g.checkDelete(t)}),["prevent"])},N,8,V)])])})),128))])])])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(E,{pages:r.pagination,onEmitPage:g.getProducts},null,8,["pages","onEmitPage"]),Object(o["createVNode"])(k,{ref:"productModal",product:r.tempProduct,onUpdateProduct:g.updateProduct},null,8,["product","onUpdateProduct"]),Object(o["createVNode"])(w,{ref:"deleteModal",item:r.tempProduct,itemClass:"商品",onEmitDelete:g.delProduct},null,8,["item","onEmitDelete"]),Object(o["createVNode"])(P,{active:r.isLoading},null,8,["active"])],64)}var w=c("5530"),P=c("1da1"),x=(c("96cf"),c("99af"),c("d3b7"),c("e9c4"),c("1799")),y=(c("a4d3"),c("e01a"),function(e){return Object(o["pushScopeId"])("data-v-9152aef6"),e=e(),Object(o["popScopeId"])(),e}),U={class:"modal fade",id:"modal_product",tabindex:"-1",ref:"modal"},M={class:"modal-dialog modal-lg modal-dialog-centered"},C=y((function(){return Object(o["createElementVNode"])("div",{class:"modal-header p-2 mb-3"},[Object(o["createElementVNode"])("h5",{class:"modal-title"},"編輯商品"),Object(o["createElementVNode"])("button",{class:"btn-close",type:"button","data-bs-dismiss":"modal","aria-label":"Close"})],-1)})),D={class:"row"},I={class:"col-sm-7"},B={class:"hstack"},T={class:"mb-4 me-2 w-70"},S=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"productTitle"},"品項名稱*：",-1)})),_={class:"mb-4 form-switch w-30 text-center p-0 d-flex flex-column align-items-center"},$=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label",for:"productSwitch"},"上架",-1)})),R={class:"hstack"},q={class:"mb-4 me-2 w-70"},L=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"productCategory"},"品項分類*：",-1)})),z={class:"mb-4 w-30"},A=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"productUnit"},"單位*：",-1)})),F={class:"hstack"},J={class:"mb-4 w-50 me-2"},X=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"productOriginPrice"},"定價*：",-1)})),G={class:"mb-4 w-50"},H=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"productPrice"},"售價*：",-1)})),K={class:"form-floating mb-4"},Q=y((function(){return Object(o["createElementVNode"])("label",{for:"productDescription"},"商品描述：",-1)})),W={class:"form-floating mb-4"},Y=y((function(){return Object(o["createElementVNode"])("label",{for:"productContent"},"相關說明：",-1)})),Z={class:"col-sm-5"},ee=y((function(){return Object(o["createElementVNode"])("div",{class:"mb-1"},"商品主圖：",-1)})),te={key:0,class:"text-center p-3"},ce=y((function(){return Object(o["createElementVNode"])("div",{class:"spinner-grow"},[Object(o["createElementVNode"])("div",{class:"visually-hidden"},"載入中……")],-1)})),oe=[ce],ne={key:1,class:"vstack mt-"},re=["src"],ae={class:"mt-4"},le=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"uploadImg"},"或上傳檔案：",-1)})),ie={class:"mt-4"},de=y((function(){return Object(o["createElementVNode"])("label",{class:"form-label mb-1",for:"mutitleImg"},"多圖連結：",-1)})),se={class:"input-group"},ue=["onClick"],me=["src"],pe=y((function(){return Object(o["createElementVNode"])("div",{class:"modal-footer p-0 pt-2 mt-3"},[Object(o["createElementVNode"])("button",{class:"btn btn-cyan-600 text-white w-30",type:"submit"},[Object(o["createElementVNode"])("i",{class:"bi bi-check-lg me-2"}),Object(o["createTextVNode"])("送出")]),Object(o["createElementVNode"])("button",{class:"btn btn-outline-gray-600 w-20",type:"button","data-bs-dismiss":"modal"},"取消")],-1)}));function be(e,t,c,n,r,a){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",U,[Object(o["createElementVNode"])("div",M,[Object(o["createElementVNode"])("form",{class:"modal-content p-3",onSubmit:t[13]||(t[13]=Object(o["withModifiers"])((function(){return a.update&&a.update.apply(a,arguments)}),["prevent"]))},[C,Object(o["createElementVNode"])("div",D,[Object(o["createElementVNode"])("div",I,[Object(o["createElementVNode"])("div",B,[Object(o["createElementVNode"])("div",T,[S,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"productTitle",type:"text",required:"","onUpdate:modelValue":t[0]||(t[0]=function(e){return r.tempProduct.title=e})},null,512),[[o["vModelText"],r.tempProduct.title]])]),Object(o["createElementVNode"])("div",_,[$,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-check-input m-0 p-2 shadow-0",id:"productSwitch",type:"checkbox",role:"switch","onUpdate:modelValue":t[1]||(t[1]=function(e){return r.tempProduct.is_enabled=e}),"true-value":1,"false-value":0},null,512),[[o["vModelCheckbox"],r.tempProduct.is_enabled]])])]),Object(o["createElementVNode"])("div",R,[Object(o["createElementVNode"])("div",q,[L,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"productCategory",type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return r.tempProduct.category=e}),required:""},null,512),[[o["vModelText"],r.tempProduct.category]])]),Object(o["createElementVNode"])("div",z,[A,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"productUnit",type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return r.tempProduct.unit=e}),required:""},null,512),[[o["vModelText"],r.tempProduct.unit]])])]),Object(o["createElementVNode"])("div",F,[Object(o["createElementVNode"])("div",J,[X,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"productOriginPrice",type:"number","onUpdate:modelValue":t[4]||(t[4]=function(e){return r.tempProduct.origin_price=e}),placeholder:"請輸入定價",step:"1",min:"0",required:""},null,512),[[o["vModelText"],r.tempProduct.origin_price]])]),Object(o["createElementVNode"])("div",G,[H,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"productPrice",type:"number","onUpdate:modelValue":t[5]||(t[5]=function(e){return r.tempProduct.price=e}),placeholder:"請輸入售價",step:"1",min:"0",required:""},null,512),[[o["vModelText"],r.tempProduct.price]])])]),Object(o["createElementVNode"])("div",K,[Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"form-control textarea",id:"productDescription","onUpdate:modelValue":t[6]||(t[6]=function(e){return r.tempProduct.description=e})},null,512),[[o["vModelText"],r.tempProduct.description]]),Q]),Object(o["createElementVNode"])("div",W,[Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{class:"form-control textarea",id:"productContent","onUpdate:modelValue":t[7]||(t[7]=function(e){return r.tempProduct.content=e})},null,512),[[o["vModelText"],r.tempProduct.content]]),Y])]),Object(o["createElementVNode"])("div",Z,[ee,r.isUploading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",te,oe)):Object(o["createCommentVNode"])("",!0),r.tempProduct.imageUrl?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ne,[Object(o["createElementVNode"])("button",{class:"btn me-auto hover-red",type:"button",onClick:t[8]||(t[8]=Object(o["withModifiers"])((function(e){return r.tempProduct.imageUrl=""}),["prevent"])),title:"移除"},"X"),Object(o["createElementVNode"])("img",{class:"img-fluid img-thumbnail",src:r.tempProduct.imageUrl,alt:"圖片連結無效"},null,8,re)])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm my-2",type:"url",placeholder:"圖片網址🔗","onUpdate:modelValue":t[9]||(t[9]=function(e){return r.tempProduct.imageUrl=e})},null,512),[[o["vModelText"],r.tempProduct.imageUrl,void 0,{trim:!0}]]),Object(o["createElementVNode"])("div",ae,[le,Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"uploadImg",type:"file",ref:"imgInput",onChange:t[10]||(t[10]=Object(o["withModifiers"])((function(){return a.uploadImg&&a.uploadImg.apply(a,arguments)}),["prevent"]))},null,544)]),Object(o["createElementVNode"])("div",ie,[de,Object(o["createElementVNode"])("div",se,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"form-control form-control-sm",id:"uploadImg",type:"url",placeholder:"圖片網址🔗","onUpdate:modelValue":t[11]||(t[11]=function(e){return r.imageUrl=e})},null,512),[[o["vModelText"],r.imageUrl,void 0,{trim:!0}]]),Object(o["createElementVNode"])("button",{class:"btn btn-sm btn-outline-gray-500",type:"button",onClick:t[12]||(t[12]=Object(o["withModifiers"])((function(){return a.addImage&&a.addImage.apply(a,arguments)}),["prevent"]))},"新增圖片")]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(r.tempProduct.imagesUrl,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:"mt-2 vstack",key:t},[Object(o["createElementVNode"])("button",{class:"btn me-auto hover-red",title:"移除",onClick:Object(o["withModifiers"])((function(t){return a.removeImg(e)}),["prevent"])},"X",8,ue),Object(o["createElementVNode"])("img",{class:"img-fluid img-thumbnail",src:e,title:"圖片預覽",alt:"圖片連結無效"},null,8,me)])})),128))])])]),pe],32)])],512)}c("4de4");var fe=c("e0ae"),je={data:function(){return{tempProduct:{},imageUrl:"",isUploading:!1}},inject:["tokenValue"],mixins:[fe["a"]],props:{product:{type:Object,default:function(){return{}}}},watch:{product:function(){this.tempProduct=Object(w["a"])({},this.product)}},methods:{update:function(){this.$emit("updateProduct",this.tempProduct)},uploadImg:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var c,o,n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tempProduct.imageUrl="",e.isUploading=!0,c="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/upload\n      "),o=e.$refs.imgInput.files[0],n=new FormData,n.append("file-to-upload",o),t.prev=6,t.next=9,fetch(c,{method:"post",headers:{Authorization:e.tokenValue},body:n});case 9:return r=t.sent,t.next=12,r.json();case 12:a=t.sent,a.success&&(e.tempProduct.imageUrl=a.imageUrl,e.isUploading=!1),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](6),console.error(t.t0);case 19:case"end":return t.stop()}}),t,null,[[6,16]])})))()},addImage:function(){this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),""!==this.imageUrl&&this.tempProduct.imagesUrl.unshift(this.imageUrl),this.imageUrl=""},removeImg:function(e){this.tempProduct.imagesUrl=this.tempProduct.imagesUrl.filter((function(t){return t!==e}))}}},Oe=(c("4082"),c("6b0d")),he=c.n(Oe);const ge=he()(je,[["render",be],["__scopeId","data-v-9152aef6"]]);var ve=ge,Ve=c("053c"),Ee={data:function(){return{products:[],tempProduct:{},pagination:{},currentPage:1,isNew:!1,isLoading:!1}},components:{Pagination:x["a"],ProductModal:ve,DeleteModal:Ve["a"]},inject:["tokenValue","pushToast"],methods:{getProducts:function(){var e=arguments,t=this;return Object(P["a"])(regeneratorRuntime.mark((function c(){var o,n,r,a;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return o=e.length>0&&void 0!==e[0]?e[0]:1,t.isLoading=!0,t.currentPage=o,n="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/products?page=").concat(t.currentPage,"\n      "),c.prev=4,c.next=7,fetch(n,{headers:{Authorization:t.tokenValue}});case 7:return r=c.sent,c.next=10,r.json();case 10:a=c.sent,t.products=a.products,t.pagination=a.pagination,c.next=18;break;case 15:c.prev=15,c.t0=c["catch"](4),console.error(c.t0);case 18:t.isLoading=!1;case 19:case"end":return c.stop()}}),c,null,[[4,15]])})))()},openModal:function(e,t){this.tempProduct=e?{}:Object(w["a"])({},t),this.isNew=e,this.$refs.productModal.showModal()},updateProduct:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function c(){var o,n,r,a,l;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return t.$refs.productModal.hideModal(),t.isNew?(o="\n          ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/product"),n="post",r=1):(o="\n          ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/product/").concat(e.id,"\n        "),n="put",r=t.currentPage),c.next=4,fetch(o,{method:n,headers:{Authorization:t.tokenValue,"Content-Type":"application/json"},body:JSON.stringify({data:Object(w["a"])({},e)})});case 4:return a=c.sent,c.next=7,a.json();case 7:l=c.sent,t.getProducts(r),t.pushToast(l,"產品"),t.isNew=!1;case 11:case"end":return c.stop()}}),c)})))()},checkDelete:function(e){this.tempProduct=Object(w["a"])({},e),this.$refs.deleteModal.showModal()},delProduct:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function c(){var o,n,r;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return o="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/product/").concat(e.id,"\n      "),c.prev=1,c.next=4,fetch(o,{method:"delete",headers:{Authorization:t.tokenValue}});case 4:return n=c.sent,c.next=7,n.json();case 7:r=c.sent,t.pushToast(r,"產品"),t.getProducts(t.currentPage),c.next=15;break;case 12:c.prev=12,c.t0=c["catch"](1),console.error(c.t0);case 15:t.$refs.deleteModal.hideModal();case 16:case"end":return c.stop()}}),c,null,[[1,12]])})))()}},created:function(){this.getProducts()}};c("d947");const Ne=he()(Ee,[["render",k],["__scopeId","data-v-217a2e33"]]);t["default"]=Ne}}]);
//# sourceMappingURL=chunk-bfd145c6.a7e25800.js.map