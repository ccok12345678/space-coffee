(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d84aca5c"],{"291b":function(e,t,c){"use strict";c.r(t);var l=c("7a23"),n=Object(l["createElementVNode"])("i",{class:"bi bi-file-earmark-plus"},null,-1),a=[n],o={key:0,class:"alert alert-info"},r={key:1,class:"w-100 overflow-auto text-nowrap text-center"},i={key:0,class:"table table-sm table-light table-striped table-hover align-middle"},s=Object(l["createElementVNode"])("thead",null,[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("th",null,"日期"),Object(l["createElementVNode"])("th",null,"標題"),Object(l["createElementVNode"])("th",null,"作者"),Object(l["createElementVNode"])("th",null,"公開"),Object(l["createElementVNode"])("th")])],-1),d={key:0,class:"text-success"},u={key:1,class:"text-danger"},m=["onClick"],b=Object(l["createElementVNode"])("i",{class:"bi bi-pencil-square"},null,-1),p=[b],j=["onClick"],O=Object(l["createElementVNode"])("i",{class:"bi bi-trash"},null,-1),h=[O];function f(e,t,c,n,b,O){var f=Object(l["resolveComponent"])("ArticleModal"),v=Object(l["resolveComponent"])("Pagination"),g=Object(l["resolveComponent"])("DeleteModal"),V=Object(l["resolveComponent"])("VueLoading");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createElementVNode"])("a",{class:"btn btn-secondary btn-fixed fs-3 hover-half-transparent text-light border-0",title:"新增文章",onClick:t[0]||(t[0]=Object(l["withModifiers"])((function(e){return O.openModal(!0)}),["prevent"]))},a),b.articles.length?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",o,"還未新增文章")),b.articles.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("section",r,[(Object(l["openBlock"])(),Object(l["createElementBlock"])("table",i,[s,Object(l["createElementVNode"])("tbody",null,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(b.articles,(function(t){return Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:b.articles.id},[Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.$filters.date(t.create_at)),1),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(t.title),1),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(t.author),1),Object(l["createElementVNode"])("td",null,[t.isPublic?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",d,"已公開")):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",u,"未公開"))]),Object(l["createElementVNode"])("td",null,[Object(l["createElementVNode"])("button",{class:"border-0 hover-gray py-2 d-block w-100",type:"button",title:"編輯",onClick:Object(l["withModifiers"])((function(e){return O.openModal(!1,t)}),["prevent"])},p,8,m),Object(l["createElementVNode"])("button",{class:"border-0 hover-red py-2 d-block w-100",type:"button",title:"刪除",onClick:Object(l["withModifiers"])((function(e){return O.checkDelete(t)}),["prevent"])},h,8,j)])])})),128))])]))])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(f,{ref:"articleModal",article:b.tempArticle,onEmitArticle:O.updateArticle},null,8,["article","onEmitArticle"]),Object(l["createVNode"])(v,{pages:b.pagination,onEmitPage:O.getArticles},null,8,["pages","onEmitPage"]),Object(l["createVNode"])(g,{ref:"deleteModal",item:b.tempArticle,itemClass:"文章",onEmitDelete:O.delArticle},null,8,["item","onEmitDelete"]),Object(l["createVNode"])(V,{active:b.isLoading},null,8,["active"])],64)}var v=c("5530"),g=c("1da1"),V=(c("96cf"),c("99af"),c("d3b7"),c("e9c4"),c("1799")),E=(c("a4d3"),c("e01a"),function(e){return Object(l["pushScopeId"])("data-v-814b4562"),e=e(),Object(l["popScopeId"])(),e}),N={class:"modal fade",id:"modal_articles",tabindex:"-1",ref:"modal"},k={class:"modal-dialog modal-lg modal-dialog-centered"},w=E((function(){return Object(l["createElementVNode"])("div",{class:"modal-header p-2 mb-3"},[Object(l["createElementVNode"])("h5",{class:"modal-title"},"編輯文章"),Object(l["createElementVNode"])("button",{class:"btn-close",type:"button","data-bs-dismiss":"modal","aria-label":"Close"})],-1)})),y={class:"modal-body"},x={key:1,class:"row gy-2"},A=E((function(){return Object(l["createElementVNode"])("div",{class:"col-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"標題*：")],-1)})),C={class:"col-9"},B=E((function(){return Object(l["createElementVNode"])("div",{class:"col-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"日期*：")],-1)})),M={class:"col-9"},D=E((function(){return Object(l["createElementVNode"])("div",{class:"col-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"作者*：")],-1)})),P={class:"col-9"},T=E((function(){return Object(l["createElementVNode"])("div",{class:"col-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"標籤 ：")],-1)})),S={class:"col-9"},U=E((function(){return Object(l["createElementVNode"])("button",{class:"btn p-1 text-info",type:"submit",title:"新增標籤"},[Object(l["createElementVNode"])("i",{class:"fs-5 bi bi-file-earmark-plus"})],-1)})),_=E((function(){return Object(l["createElementVNode"])("div",{class:"col-3"},null,-1)})),I={class:"col-9"},L={class:"d-flex flex-wrap"},z={class:"py-1 px-2"},R=["onClick"],$=E((function(){return Object(l["createElementVNode"])("div",{class:"col-4 col-md-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"圖片連結：")],-1)})),q={class:"col-8 col-md-9"},F=E((function(){return Object(l["createElementVNode"])("div",{class:"col-4 col-md-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"上傳圖檔：")],-1)})),J={class:"col-8 col-md-9"},K={key:0,class:"text-center p-3"},X=E((function(){return Object(l["createElementVNode"])("div",{class:"spinner-grow"},[Object(l["createElementVNode"])("div",{class:"visually-hidden"},"載入中……")],-1)})),G=[X],H={key:0,class:"col-12 col-sm-8 mx-auto"},Q=["src"],W=E((function(){return Object(l["createElementVNode"])("div",{class:"w-100"},null,-1)})),Y=E((function(){return Object(l["createElementVNode"])("div",{class:"col-3 d-flex"},[Object(l["createElementVNode"])("div",{class:"my-auto ms-auto"},"公開*：")],-1)})),Z={class:"col-9"},ee={class:"form-switch d-flex align-items-center"},te={class:"form-label m-0",for:"articleIsEnabled"},ce={key:0,class:"text-success"},le={key:1,class:"text-danger"},ne={class:"col-12"},ae={class:"form-floating"},oe=E((function(){return Object(l["createElementVNode"])("label",{for:"articleDescription"},"文章摘要",-1)})),re={class:"col-12"},ie={class:"form-floating"},se=E((function(){return Object(l["createElementVNode"])("label",{for:"articleContent"},"文章內容*",-1)})),de={class:"modal-footer p-0 pt-2 mt-3"},ue=["disabled"],me=E((function(){return Object(l["createElementVNode"])("i",{class:"bi bi-check-lg me-2"},null,-1)})),be=Object(l["createTextVNode"])("送出"),pe=[me,be],je=E((function(){return Object(l["createElementVNode"])("button",{class:"btn btn-outline-gray-600 w-20",type:"button","data-bs-dismiss":"modal"},"取消",-1)}));function Oe(e,t,c,n,a,o){var r=Object(l["resolveComponent"])("Placeholder");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",N,[Object(l["createElementVNode"])("div",k,[Object(l["createElementVNode"])("form",{class:"modal-content p-3",onSubmit:t[11]||(t[11]=Object(l["withModifiers"])((function(){return o.submitArticle&&o.submitArticle.apply(o,arguments)}),["prevent"]))},[w,Object(l["createElementVNode"])("div",y,[a.isLoading?(Object(l["openBlock"])(),Object(l["createBlock"])(r,{key:0,bgColor:"gray-300"})):Object(l["createCommentVNode"])("",!0),a.isLoading?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",x,[A,Object(l["createElementVNode"])("div",C,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{class:"form-control",type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return a.tempArticle.title=e}),required:""},null,512),[[l["vModelText"],a.tempArticle.title]])]),B,Object(l["createElementVNode"])("div",M,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{class:"form-control",type:"date",required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.create_at=e})},null,512),[[l["vModelText"],a.create_at]])]),D,Object(l["createElementVNode"])("div",P,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{class:"form-control",type:"text","onUpdate:modelValue":t[2]||(t[2]=function(e){return a.tempArticle.author=e}),required:""},null,512),[[l["vModelText"],a.tempArticle.author]])]),T,Object(l["createElementVNode"])("div",S,[Object(l["createElementVNode"])("form",{class:"hstack",onSubmit:t[5]||(t[5]=Object(l["withModifiers"])((function(){return o.addTag&&o.addTag.apply(o,arguments)}),["prevent"]))},[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{class:"form-control w-40",type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return a.tag=e}),onKeyup:t[4]||(t[4]=Object(l["withKeys"])(Object(l["withModifiers"])((function(){return o.addTag&&o.addTag.apply(o,arguments)}),["prevent"]),["enter"]))},null,544),[[l["vModelText"],a.tag,void 0,{trim:!0}]]),U],32)]),_,Object(l["createElementVNode"])("div",I,[Object(l["createElementVNode"])("div",L,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.tags,(function(e,t){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{class:"rounded bg-gray-300 hstack me-1 mt-1",key:t},[Object(l["createElementVNode"])("span",z,Object(l["toDisplayString"])(e),1),Object(l["createElementVNode"])("button",{class:"btn btn-sm",type:"button",onClick:Object(l["withModifiers"])((function(t){return o.delTag(e)}),["prevent"])},"X",8,R)])})),128))])]),$,Object(l["createElementVNode"])("div",q,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{class:"form-control",type:"url","onUpdate:modelValue":t[6]||(t[6]=function(e){return a.tempArticle.image=e})},null,512),[[l["vModelText"],a.tempArticle.image]])]),F,Object(l["createElementVNode"])("div",J,[Object(l["createElementVNode"])("input",{class:"form-control",type:"file",onChange:t[7]||(t[7]=Object(l["withModifiers"])((function(){return o.uploadImg&&o.uploadImg.apply(o,arguments)}),["prevent"])),ref:"imgInput"},null,544),a.isUploading?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",K,G)):Object(l["createCommentVNode"])("",!0)]),"image"in a.tempArticle?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",H,[Object(l["createElementVNode"])("img",{class:"img-fluid",src:a.tempArticle.image,title:"圖片預覽"},null,8,Q)])):Object(l["createCommentVNode"])("",!0),W,Y,Object(l["createElementVNode"])("div",Z,[Object(l["createElementVNode"])("div",ee,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{class:"form-check-input p-2 me-2 my-2",id:"articleIsEnabled",type:"checkbox",role:"switch","onUpdate:modelValue":t[8]||(t[8]=function(e){return a.isPublic=e}),"true-value":!0,"false-value":!1},null,512),[[l["vModelCheckbox"],a.isPublic]]),Object(l["createElementVNode"])("label",te,[a.isPublic?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",ce,"公開")):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",le,"未公開"))])])]),Object(l["createElementVNode"])("div",ne,[Object(l["createElementVNode"])("div",ae,[Object(l["withDirectives"])(Object(l["createElementVNode"])("textarea",{class:"article-description form-control",id:"articleDescription",row:"10",placeholder:"請輸入內容","onUpdate:modelValue":t[9]||(t[9]=function(e){return a.tempArticle.description=e})},null,512),[[l["vModelText"],a.tempArticle.description]]),oe])]),Object(l["createElementVNode"])("div",re,[Object(l["createElementVNode"])("div",ie,[Object(l["withDirectives"])(Object(l["createElementVNode"])("textarea",{class:"article-content form-control",id:"articleContent",row:"10",placeholder:"請輸入文章內容","onUpdate:modelValue":t[10]||(t[10]=function(e){return a.tempArticle.content=e}),required:""},null,512),[[l["vModelText"],a.tempArticle.content]]),se])])]))]),Object(l["createElementVNode"])("div",de,[Object(l["createElementVNode"])("button",{class:"btn btn-cyan-600 text-white w-30",type:"submit",disabled:a.isLoading},pe,8,ue),je])],32)])],512)}var he=c("3835"),fe=(c("ac1f"),c("1276"),c("4de4"),c("e0ae")),ve=c("c9a0"),ge={data:function(){return{tempArticle:{},create_at:"",tags:[],tag:"",isPublic:!1,isLoading:!1,isUploading:!1}},components:{Placeholder:ve["a"]},props:{article:{type:Object,default:function(){return{}}}},watch:{article:function(){if(this.tempArticle={},"id"in this.article)this.getArticle();else{this.isPublic=!1,this.tags=[];var e=new Date(Date.now()).toISOString().split("T"),t=Object(he["a"])(e,1);this.create_at=t[0]}}},inject:["tokenValue"],mixins:[fe["a"]],methods:{submitArticle:function(){this.tempArticle.isPublic=this.isPublic,this.tempArticle.tag=this.tags,this.tempArticle.create_at=Math.floor(new Date(this.create_at)/1e3),this.$emit("emit-article",this.tempArticle)},getArticle:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var c,l,n,a,o,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,l=e.article.id,n="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/article/").concat(l,"\n      "),t.next=5,fetch(n,{headers:{Authorization:e.tokenValue}});case 5:return a=t.sent,t.next=8,a.json();case 8:return o=t.sent,t.next=11,o.article;case 11:e.tempArticle=t.sent,r=new Date(1e3*e.tempArticle.create_at).toISOString().split("T"),i=Object(he["a"])(r,1),e.create_at=i[0],e.isPublic=e.tempArticle.isPublic,e.tags=null!==(c=e.tempArticle.tag)&&void 0!==c?c:[],e.isLoading=!1;case 18:case"end":return t.stop()}}),t)})))()},addTag:function(){this.tag&&(this.tags.push(this.tag),this.tag="")},delTag:function(e){this.tags=this.tags.filter((function(t){return t!==e}))},uploadImg:function(){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function t(){var c,l,n,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isUploading=!0,c="\n        {process.env.VUE_APP_API}/api/".concat("ccok-api","/admin/upload\n      "),l=e.$refs.imgInput.files[0],n=new FormData,n.append("file-to-upload",l),t.prev=5,t.next=8,fetch(c,{method:"post",headers:{Authorization:e.tokenValue},body:n});case 8:return a=t.sent,t.next=11,a.json();case 11:o=t.sent,o.success&&(e.tempArticle.image=o.imageUrl,e.isUploading=!1),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](5),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[5,15]])})))()}}},Ve=(c("86e3"),c("6b0d")),Ee=c.n(Ve);const Ne=Ee()(ge,[["render",Oe],["__scopeId","data-v-814b4562"]]);var ke=Ne,we=c("053c"),ye={data:function(){return{articles:[],tempArticle:{},pagination:{},currentPage:1,isNew:!1,isLoading:!1}},components:{Pagination:V["a"],ArticleModal:ke,DeleteModal:we["a"]},inject:["tokenValue","pushToast"],methods:{getArticles:function(){var e=arguments,t=this;return Object(g["a"])(regeneratorRuntime.mark((function c(){var l,n,a,o;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return l=e.length>0&&void 0!==e[0]?e[0]:1,t.isLoading=!0,t.currentPage=l,n="\n          ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/articles?page=").concat(l,"\n        "),c.next=6,fetch(n,{headers:{Authorization:t.tokenValue}});case 6:return a=c.sent,c.next=9,a.json();case 9:o=c.sent,t.articles=o.articles,t.pagination=o.pagination,t.isLoading=!1;case 13:case"end":return c.stop()}}),c)})))()},openModal:function(e,t){this.isNew=e,this.tempArticle=e?{}:Object(v["a"])({},t),this.$refs.articleModal.showModal()},updateArticle:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function c(){var l,n,a,o,r,i;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return t.$refs.articleModal.hideModal(),t.isNew?(l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/article"),n="post",a=1):(l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/article/").concat(e.id),n="put",a=t.currentPage),o={data:Object(v["a"])({},e)},c.prev=3,c.next=6,fetch(l,{method:n,headers:{Authorization:t.tokenValue,"Content-Type":"application/json"},body:JSON.stringify(o)});case 6:return r=c.sent,c.next=9,r.json();case 9:i=c.sent,t.getArticles(a),t.pushToast(i,"部落格"),c.next=17;break;case 14:c.prev=14,c.t0=c["catch"](3),console.error(c.t0);case 17:t.isNew=!1;case 18:case"end":return c.stop()}}),c,null,[[3,14]])})))()},checkDelete:function(e){this.tempArticle=Object(v["a"])({},e),this.$refs.deleteModal.showModal()},delArticle:function(e){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function c(){var l,n,a;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return t.$refs.deleteModal.hideModal(),l="".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/article/").concat(e.id),c.next=4,fetch(l,{method:"delete",headers:{Authorization:t.tokenValue}});case 4:return n=c.sent,c.next=7,n.json();case 7:a=c.sent,t.pushToast(a,"部落格"),a.success&&t.getArticles(t.currentPage);case 10:case"end":return c.stop()}}),c)})))()}},created:function(){this.getArticles()}};const xe=Ee()(ye,[["render",f]]);t["default"]=xe},"86e3":function(e,t,c){"use strict";c("afb8")},afb8:function(e,t,c){},c9a0:function(e,t,c){"use strict";var l=c("7a23"),n={class:"container-lg d-flex flex-column align-items-center my-5"},a={class:"row gy-4 w-80 placeholder-wave"},o=Object(l["createElementVNode"])("div",{class:"col-6"},null,-1),r=Object(l["createElementVNode"])("div",{class:"col-7"},null,-1),i=Object(l["createElementVNode"])("div",{class:"col-4"},null,-1),s=Object(l["createElementVNode"])("div",{class:"col-7"},null,-1),d=Object(l["createElementVNode"])("div",{class:"col-2"},null,-1),u=Object(l["createElementVNode"])("div",{class:"col-2"},null,-1),m=Object(l["createElementVNode"])("div",{class:"col-4"},null,-1);function b(e,t,c,b,p,j){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",n,[Object(l["createElementVNode"])("div",a,[Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-6 placeholder","bg-".concat(c.bgColor)])},null,2),o,Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-5 placeholder","bg-".concat(c.bgColor)])},null,2),r,Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-8 placeholder","bg-".concat(c.bgColor)])},null,2),i,Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-5 placeholder","bg-".concat(c.bgColor)])},null,2),s,Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-10 placeholder","bg-".concat(c.bgColor)])},null,2),d,Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-10 placeholder","bg-".concat(c.bgColor)])},null,2),u,Object(l["createElementVNode"])("div",{class:Object(l["normalizeClass"])(["col-8 placeholder","bg-".concat(c.bgColor)])},null,2),m])])}var p={props:{bgColor:{type:String,default:function(){return"gray-300"}}}},j=c("6b0d"),O=c.n(j);const h=O()(p,[["render",b]]);t["a"]=h}}]);
//# sourceMappingURL=chunk-d84aca5c.73d84f58.js.map