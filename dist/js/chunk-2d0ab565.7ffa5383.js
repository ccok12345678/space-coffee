(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab565"],{"159d":function(e,t,r){"use strict";r.r(t);r("b0c0");var c=r("7a23"),o={key:0,class:"alert alert-info"},l={key:1,class:"w-100 overflow-auto text-nowrap"},n={class:"table table-sm table-light table-striped table-hover align-middle"},a=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"下單時間"),Object(c["createElementVNode"])("th",null,"買家"),Object(c["createElementVNode"])("th",{class:"text-center d-none d-sm-table-cell"},"訂單內容"),Object(c["createElementVNode"])("th",{class:"text-center d-table-cell d-sm-none"},[Object(c["createTextVNode"])("訂單編號"),Object(c["createElementVNode"])("i",{class:"bi bi-eye ms-2"})]),Object(c["createElementVNode"])("th",{class:"text-center"},"金額"),Object(c["createElementVNode"])("th",{class:"text-center"},"付款"),Object(c["createElementVNode"])("th")])],-1),d={class:"d-none d-sm-table-cell"},s=["onClick"],i={class:"d-table-cell d-sm-none"},b=["onClick"],m={key:0,class:"text-success"},p={key:1,class:"text-danger"},O=["onClick"],u=Object(c["createElementVNode"])("i",{class:"bi bi-pencil-square"},null,-1),j=[u],E=["onClick"],h=Object(c["createElementVNode"])("i",{class:"bi bi-trash"},null,-1),f=[h];function V(e,t,r,u,h,V){var y=Object(c["resolveComponent"])("Pagination"),k=Object(c["resolveComponent"])("OrderModal"),N=Object(c["resolveComponent"])("DeleteModal"),v=Object(c["resolveComponent"])("VueLoading");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[h.orders.length?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",o,"還未收到訂單！")),h.orders.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("section",l,[Object(c["createElementVNode"])("table",n,[a,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(h.orders,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t.id},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.date(t.create_at)),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(t.user.name),1),Object(c["createElementVNode"])("td",d,[Object(c["createElementVNode"])("a",{class:"link-dark text-decoration-none",href:"#",onClick:Object(c["withModifiers"])((function(e){return V.openModal(t,!1)}),["prevent"]),title:"僅可檢視"},[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.products,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("p",{class:"m-0",key:t},"• "+Object(c["toDisplayString"])(e.product.title)+"（"+Object(c["toDisplayString"])(e.product.unit)+"）*"+Object(c["toDisplayString"])(e.product.num),1)})),128))],8,s)]),Object(c["createElementVNode"])("td",i,[Object(c["createElementVNode"])("a",{class:"link-dark text-decoration-none",href:"#",onClick:Object(c["withModifiers"])((function(e){return V.openModal(t,!1)}),["prevent"])},"• "+Object(c["toDisplayString"])(t.id),9,b)]),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.$filters.currency(t.total)),1),Object(c["createElementVNode"])("td",null,[t.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",m,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",p,"未付款"))]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("button",{class:"border-0 hover-gray p-2 d-block w-100",type:"button",title:"檢視編輯",onClick:Object(c["withModifiers"])((function(e){return V.openModal(t,!0)}),["prevent"])},j,8,O),Object(c["createElementVNode"])("button",{class:"border-0 hover-red p-2 d-block w-100",type:"button",title:"刪除",onClick:Object(c["withModifiers"])((function(e){return V.checkDelete(t)}),["prevent"])},f,8,E)])])})),128))])])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(y,{pages:h.pagination,onEmitPage:V.getOrders},null,8,["pages","onEmitPage"]),Object(c["createVNode"])(k,{ref:"orderModal",order:h.tempOrder,onEmitOrder:V.updateOrder},null,8,["order","onEmitOrder"]),Object(c["createVNode"])(N,{ref:"deleteModal",item:h.tempOrder,itemClass:"訂單",onEmitDelete:V.delOrder},null,8,["item","onEmitDelete"]),Object(c["createVNode"])(v,{active:h.isLoading},null,8,["active"])],64)}var y=r("5530"),k=r("1da1"),N=(r("96cf"),r("99af"),r("d3b7"),r("e9c4"),r("1799")),v={class:"modal fade text-nowrap",id:"modal_order",tabindex:"-1",ref:"modal"},g={class:"modal-dialog modal-dialog-centered overflow-auto"},w={key:0,class:"modal-content overflow-auto"},x={class:"modal-header p-3"},B={key:0,class:"m-0"},C={key:1,class:"m-0"},M=Object(c["createTextVNode"])("修改訂單"),D=Object(c["createElementVNode"])("i",{class:"bi bi-pencil-square ms-2"},null,-1),S=[M,D],T=Object(c["createElementVNode"])("button",{class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),$={class:"modal-body"},P=Object(c["createElementVNode"])("h6",{class:"fw-bold"},"訂購人資訊",-1),L={class:"row"},_=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1 d-block",for:"buyerName"},"訂購人：",-1),z={class:"col-9"},R=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"buyerEmail"},"電子信箱：",-1),A={class:"col-9"},J=["readonly"],U=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"buyerTel"},"電話：",-1),F={class:"col-9"},I=["readonly"],q=Object(c["createElementVNode"])("label",{class:"col-3 col-form-label py-1",for:"buyerAddress"},"地址：",-1),X={class:"col-9"},G=["readonly"],H=Object(c["createElementVNode"])("div",{class:"devider border-gray-500 w-100 mb-3"},null,-1),K=Object(c["createElementVNode"])("h6",{class:"fw-bold"},"訂單狀態",-1),Q={class:"row"},W=Object(c["createElementVNode"])("div",{class:"col-3 py-1"},"訂單編號：",-1),Y={class:"col-9"},Z={class:"py-1 ps-2"},ee=Object(c["createElementVNode"])("div",{class:"col-3 py-1"},"下單日期：",-1),te={class:"col-9"},re={class:"py-1 ps-2"},ce=Object(c["createElementVNode"])("div",{class:"col-3 py-1"},"付款金額：",-1),oe={class:"col-9"},le={class:"py-1 ps-2"},ne=Object(c["createElementVNode"])("div",{class:"col-3 py-1"},"付款狀態：",-1),ae={class:"col-9 form-switch ps-3 d-flex align-items-center"},de=["disabled"],se={class:"form-label my-0 ms-2",for:"orderIsPaid"},ie={key:0,class:"text-success"},be={key:1,class:"text-danger"},me=Object(c["createElementVNode"])("div",{class:"devider border-gray-500 w-100 mb-3"},null,-1),pe=Object(c["createElementVNode"])("h6",{class:"fw-bold"},"訂單內容",-1),Oe={class:"list-group list-group-flush"},ue={class:"row"},je={class:"col-8"},Ee={class:"py-2 m-0"},he={class:"col-4 d-flex"},fe={class:"py-2 m-0"},Ve=["disabled","onClick"],ye={class:"modal-footer"},ke={key:0,class:"btn btn-cyan-600 text-light",type:"button","data-bs-dismiss":"modal","aria-label":"Close"},Ne=Object(c["createElementVNode"])("button",{class:"btn btn-outline-gray-600",type:"button","data-bs-dismiss":"modal","aria-label":"Close"},"取消",-1);function ve(e,t,r,o,l,n){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",v,[Object(c["createElementVNode"])("div",g,[l.tempOrder.user?(Object(c["openBlock"])(),Object(c["createElementBlock"])("form",w,[Object(c["createElementVNode"])("div",x,[l.tempOrder.isEditable?(Object(c["openBlock"])(),Object(c["createElementBlock"])("h5",C,S)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("h5",B,"檢視訂單")),T]),Object(c["createElementVNode"])("div",$,[P,Object(c["createElementVNode"])("div",L,[_,Object(c["createElementVNode"])("div",z,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-control bg-transparent ps-2 form-control-plaintext buyer-input",id:"buyerName",type:"text","onUpdate:modelValue":t[0]||(t[0]=function(e){return l.tempOrder.user.name=e}),readonly:""},null,512),[[c["vModelText"],l.tempOrder.user.name]])]),R,Object(c["createElementVNode"])("div",A,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:Object(c["normalizeClass"])(["form-control bg-transparent ps-2 buyer-input",{"form-control-plaintext":!l.tempOrder.isEditable}]),id:"buyerEmail",type:"email","onUpdate:modelValue":t[1]||(t[1]=function(e){return l.tempOrder.user.email=e}),readonly:!l.tempOrder.isEditable},null,10,J),[[c["vModelText"],l.tempOrder.user.email]])]),U,Object(c["createElementVNode"])("div",F,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:Object(c["normalizeClass"])(["form-control bg-transparent ps-2 buyer-input",{"form-control-plaintext":!l.tempOrder.isEditable}]),id:"buyerTel",type:"tel","onUpdate:modelValue":t[2]||(t[2]=function(e){return l.tempOrder.user.tel=e}),readonly:!l.tempOrder.isEditable},null,10,I),[[c["vModelText"],l.tempOrder.user.tel]])]),q,Object(c["createElementVNode"])("div",X,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:Object(c["normalizeClass"])(["form-control bg-transparent ps-2 buyer-input",{"form-control-plaintext":!l.tempOrder.isEditable}]),id:"buyerAddress",type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return l.tempOrder.user.address=e}),readonly:!l.tempOrder.isEditable},null,10,G),[[c["vModelText"],l.tempOrder.user.address]])])]),H,K,Object(c["createElementVNode"])("div",Q,[W,Object(c["createElementVNode"])("div",Y,[Object(c["createElementVNode"])("div",Z,Object(c["toDisplayString"])(l.tempOrder.id),1)]),ee,Object(c["createElementVNode"])("div",te,[Object(c["createElementVNode"])("div",re,Object(c["toDisplayString"])(e.$filters.date(l.tempOrder.create_at)),1)]),ce,Object(c["createElementVNode"])("div",oe,[Object(c["createElementVNode"])("div",le,"$ "+Object(c["toDisplayString"])(e.$filters.currency(l.tempOrder.total)),1)]),ne,Object(c["createElementVNode"])("div",ae,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input m-0 p-2 shadow-0",id:"orderIsPaid",type:"checkbox",role:"switch","onUpdate:modelValue":t[4]||(t[4]=function(e){return l.tempOrder.is_paid=e}),disabled:!l.tempOrder.isEditable},null,8,de),[[c["vModelCheckbox"],l.tempOrder.is_paid]]),Object(c["createElementVNode"])("label",se,[l.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",ie,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",be,"未付款"))])])]),me,pe,Object(c["createElementVNode"])("ul",Oe,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.tempOrder.products,(function(t,r){return Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{class:"list-group-item p-1",key:r},[Object(c["createElementVNode"])("div",ue,[Object(c["createElementVNode"])("div",je,[Object(c["createElementVNode"])("p",Ee,"• "+Object(c["toDisplayString"])(t.product.title)+"("+Object(c["toDisplayString"])(t.product.unit)+")＊"+Object(c["toDisplayString"])(t.qty),1)]),Object(c["createElementVNode"])("div",he,[Object(c["createElementVNode"])("p",fe,"單價：$ "+Object(c["toDisplayString"])(e.$filters.currency(t.total)),1),Object(c["createElementVNode"])("button",{class:"btn hover-red ms-auto",type:"button",title:"刪除品項",disabled:!l.tempOrder.isEditable,onClick:Object(c["withModifiers"])((function(e){return n.removeItem(r)}),["prevent"])},"X",8,Ve)])])])})),128))])]),Object(c["createElementVNode"])("div",ye,[l.tempOrder.isEditable?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",ke,"確認")),l.tempOrder.isEditable?(Object(c["openBlock"])(),Object(c["createElementBlock"])("button",{key:1,class:"btn btn-cyan-600 text-light",type:"button",onClick:t[5]||(t[5]=Object(c["withModifiers"])((function(){return n.updateOrder&&n.updateOrder.apply(n,arguments)}),["prevent"]))},"送出修改")):Object(c["createCommentVNode"])("",!0),Ne])])):Object(c["createCommentVNode"])("",!0)])],512)}var ge=r("e0ae"),we={data:function(){return{tempOrder:{}}},props:{order:{type:Object,default:function(){return{}}}},mixins:[ge["a"]],watch:{order:function(){this.tempOrder=JSON.parse(JSON.stringify(this.order))}},methods:{removeItem:function(e){delete this.tempOrder.products["".concat(e)]},updateOrder:function(){this.$emit("emit-order",this.tempOrder)}}},xe=r("6b0d"),Be=r.n(xe);const Ce=Be()(we,[["render",ve]]);var Me=Ce,De=r("053c"),Se={data:function(){return{orders:[],tempOrder:{},pagination:{},currentPage:1,isLoading:!1}},components:{Pagination:N["a"],OrderModal:Me,DeleteModal:De["a"]},inject:["tokenValue","pushToast"],methods:{getOrders:function(){var e=arguments,t=this;return Object(k["a"])(regeneratorRuntime.mark((function r(){var c,o,l,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return c=e.length>0&&void 0!==e[0]?e[0]:1,t.isLoading=!0,t.currentPage=c,o="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/orders?page=").concat(t.currentPage,"\n      "),r.next=6,fetch(o,{headers:{Authorization:t.tokenValue}});case 6:return l=r.sent,r.next=9,l.json();case 9:n=r.sent,t.orders=n.orders,t.pagination=n.pagination,t.isLoading=!1;case 13:case"end":return r.stop()}}),r)})))()},openModal:function(e,t){this.tempOrder=Object(y["a"])({},e),this.tempOrder.isEditable=t,this.$refs.orderModal.showModal()},updateOrder:function(e){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function r(){var c,o,l,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.$refs.orderModal.hideModal(),c="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/order/").concat(e.id,"\n      "),o={data:Object(y["a"])({},e)},r.prev=3,r.next=6,fetch(c,{method:"put",headers:{Authorization:t.tokenValue,"Content-Type":"application/json"},body:JSON.stringify(o)});case 6:return l=r.sent,r.next=9,l.json();case 9:n=r.sent,t.getOrders(t.currentPage),t.pushToast(n,"訂單"),r.next=17;break;case 14:r.prev=14,r.t0=r["catch"](3),console.error(r.t0);case 17:case"end":return r.stop()}}),r,null,[[3,14]])})))()},checkDelete:function(e){this.tempOrder=Object(y["a"])({},e),this.$refs.deleteModal.showModal()},delOrder:function(e){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function r(){var c,o,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.$refs.deleteModal.hideModal(),c="\n        ".concat("https://vue3-course-api.hexschool.io","/api/").concat("ccok-api","/admin/order/").concat(e.id,"\n      "),r.next=4,fetch(c,{method:"delete",headers:{Authorization:t.tokenValue}});case 4:return o=r.sent,r.next=7,o.json();case 7:l=r.sent,t.pushToast(l,"訂單"),t.getOrders(t.currentPage);case 10:case"end":return r.stop()}}),r)})))()}},created:function(){this.getOrders()}};const Te=Be()(Se,[["render",V]]);t["default"]=Te}}]);
//# sourceMappingURL=chunk-2d0ab565.7ffa5383.js.map